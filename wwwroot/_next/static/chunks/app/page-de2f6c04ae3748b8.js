(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3107:(e,t,r)=>{Promise.resolve().then(r.bind(r,8923))},8142:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,AuthProvider:()=>n});var l=r(5155),a=r(2115);let s=(0,a.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,a.useState)(null),[o,i]=(0,a.useState)(null),[d,c]=(0,a.useState)("");(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem("apiHostRoot");if(e){c(e);return}let t="http://localhost:5051/api";if(t){let e=t.replace(/\/?api\/?$/,"");c(e)}}catch(e){}},[]);let u=d?"".concat(d.replace(/\/$/,""),"/api"):"",x=async(e,t)=>{try{let r=await fetch("".concat(u,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!r.ok){let e="Login failed";try{let t=await r.json();e=(null==t?void 0:t.message)||e}catch(e){}throw Error(e)}let l=await r.json();n(l.token),i(e)}catch(e){throw e instanceof Error?e:Error(String(e))}},h=async()=>{try{if(!r)throw Error("Gi\xe0 disconnesso!");n(null),i(null)}catch(e){e instanceof Error?alert("Errore disconnect: "+e.message):alert("Errore disconnect: "+String(e))}};return(0,l.jsx)(s.Provider,{value:{token:r,login:x,disconnect:h,user:o,apiBaseUrl:u,apiHostRoot:d,setApiHostRoot:e=>{c(e);try{window.localStorage.setItem("apiHostRoot",e)}catch(e){}}},children:t})},o=()=>{let e=(0,a.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},8923:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var l=r(5155),a=r(2115),s=r(5695);let n=e=>{let{items:t,activeId:r,queryKey:a="tool"}=e,n=(0,s.useRouter)(),o=(0,s.useSearchParams)(),i=e=>{let t=new URLSearchParams(null==o?void 0:o.toString());t.set(a,e),n.push("/?".concat(t.toString()))};return(0,l.jsx)("header",{className:"w-full max-w-5xl mx-auto",children:(0,l.jsx)("nav",{className:"bg-white/70 backdrop-blur border border-black/10 dark:border-white/20 rounded-full px-2 py-1 flex gap-1",children:t.map(e=>{let t=e.id===r;return(0,l.jsx)("button",{onClick:()=>i(e.id),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(t?"bg-foreground text-background":"hover:bg-black/[.06] dark:hover:bg-white/[.06]"),"aria-current":t?"page":void 0,children:e.label},e.id)})})})};var o=r(9923),i=r(8142);let d=e=>{let{speed:t,max:r=1e3,label:a="Mbps",showValue:s=!1}=e,n=Math.max(0,Math.min(t,r));return(0,l.jsx)("div",{className:"w-full max-w-sm aspect-[4/3] select-none",children:(0,l.jsxs)("svg",{viewBox:"0 0 200 150",className:"w-full h-full text-foreground",children:[(0,l.jsxs)("defs",{children:[(0,l.jsxs)("linearGradient",{id:"grad",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,l.jsx)("stop",{offset:"0%",stopColor:"#22c55e"}),(0,l.jsx)("stop",{offset:"50%",stopColor:"#eab308"}),(0,l.jsx)("stop",{offset:"100%",stopColor:"#ef4444"})]}),(0,l.jsx)("filter",{id:"shadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:(0,l.jsx)("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodColor:"rgba(0,0,0,0.25)"})})]}),(0,l.jsx)("path",{d:"M20 130 A80 80 0 0 1 180 130",fill:"none",stroke:"currentColor",strokeOpacity:"0.12",strokeWidth:"16",strokeLinecap:"round"}),(0,l.jsx)("path",{d:"M20 130 A80 80 0 0 1 180 130",fill:"none",stroke:"url(#grad)",strokeWidth:"8",strokeLinecap:"round",opacity:"0.9"}),Array.from({length:13}).map((e,t)=>{let r=Math.PI/180*(-120+t/12*240),a=t%3==0?62:66,s=100+80*Math.cos(r),n=130+80*Math.sin(r),o=100+Math.cos(r)*a,i=130+Math.sin(r)*a;return(0,l.jsx)("line",{x1:s,y1:n,x2:o,y2:i,stroke:"currentColor",strokeOpacity:t%3==0?.4:.25,strokeWidth:t%3==0?2:1},t)}),(0,l.jsxs)("g",{transform:"rotate(".concat(-120+n/r*240," 100 130)"),style:{transition:"transform 180ms ease-out"},filter:"url(#shadow)",children:[(0,l.jsx)("rect",{x:"98",y:"40",width:"4",height:"92",rx:"2",fill:"currentColor"}),(0,l.jsx)("circle",{cx:"100",cy:"130",r:"7",fill:"currentColor"})]}),(0,l.jsx)("text",{x:"100",y:"145",textAnchor:"middle",fontSize:"11",fill:"currentColor",opacity:"0.6",children:"0"}),(0,l.jsx)("text",{x:"30",y:"120",textAnchor:"middle",fontSize:"11",fill:"currentColor",opacity:"0.6",children:Math.round(.25*r)}),(0,l.jsx)("text",{x:"100",y:"100",textAnchor:"middle",fontSize:"11",fill:"currentColor",opacity:"0.6",children:Math.round(.5*r)}),(0,l.jsx)("text",{x:"170",y:"120",textAnchor:"middle",fontSize:"11",fill:"currentColor",opacity:"0.6",children:Math.round(.75*r)}),s&&(0,l.jsxs)("text",{x:"100",y:"70",textAnchor:"middle",fontSize:"18",fontWeight:"600",fill:"currentColor",children:[t.toFixed(1),(0,l.jsxs)("tspan",{fontSize:"12",dy:"6",children:[" ",a]})]})]})})},c=[{id:"login",label:"Login",element:(0,l.jsx)(()=>{let{token:e,login:t,disconnect:r,user:s,apiBaseUrl:n,apiHostRoot:d,setApiHostRoot:c}=(0,i.A)(),[u,x]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[p,f]=(0,a.useState)(!1),[b,g]=(0,a.useState)(null),[j,k]=(0,a.useState)(null),[w,v]=(0,a.useState)(null),[y,N]=(0,a.useState)(null),[S,C]=(0,a.useState)(null),M=async()=>{v(null);let e=!1;if(u.trim()||(g("Campo obbligatorio"),e=!0),h||(k("Campo obbligatorio"),e=!0),!e)try{await t(u,h)}catch(e){v((e instanceof Error?e.message:String(e))||"Errore di login")}},A=async()=>{x(""),m(""),g(null),k(null),v(null),await r()};return(0,a.useEffect)(()=>{if(!n)return;let e=new AbortController;return fetch("".concat(n,"/NetworkTest/client"),{signal:e.signal}).then(e=>e.ok?e.json():null).then(e=>{if(e){var t,r;N(null!==(t=e.ip)&&void 0!==t?t:null),C(null!==(r=e.xForwardedFor)&&void 0!==r?r:null)}}).catch(()=>{}),()=>e.abort()},[n]),(0,l.jsx)("div",{className:"w-full flex items-center justify-center",children:(0,l.jsx)(o.P.div,{className:"w-full max-w-md rounded-2xl border border-black/10 dark:border-white/10 bg-white dark:bg-neutral-900 shadow-lg p-6",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0,y:-12},visible:{opacity:1,y:0,transition:{duration:.35,ease:"easeOut"}}},children:null==e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-6 text-center",children:[(0,l.jsx)("div",{className:"mx-auto mb-3 h-12 w-12 rounded-full bg-black/5 dark:bg-white/10 flex items-center justify-center",children:(0,l.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"text-foreground/80",children:[(0,l.jsx)("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2",ry:"2"}),(0,l.jsx)("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),(0,l.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Accedi"}),(0,l.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:"Inserisci le tue credenziali per continuare"})]}),(0,l.jsxs)("div",{className:"space-y-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"apiBaseUrl",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Server API"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{id:"apiBaseUrl",type:"url",placeholder:"http://server[:port]",className:"mt-1 block w-full rounded-lg border bg-white dark:bg-neutral-950 text-neutral-900 dark:text-neutral-100 placeholder-neutral-400 dark:placeholder-neutral-500 px-3 py-2 pr-16 focus:outline-none focus:ring-2 focus:ring-black/20 dark:focus:ring-white/20 border-neutral-200 dark:border-neutral-700",value:d,onChange:e=>c(e.target.value)}),(0,l.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-neutral-500 dark:text-neutral-400 select-none",children:"/api"})]}),(0,l.jsxs)("p",{className:"mt-1 text-xs text-neutral-500 dark:text-neutral-400",children:["URL effettivo: ",n||"(imposta host)"," â€” salvato nel browser."]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Username"}),(0,l.jsx)("input",{id:"username",type:"text",autoComplete:"username",className:"mt-1 block w-full rounded-lg border bg-white dark:bg-neutral-950 text-neutral-900 dark:text-neutral-100 placeholder-neutral-400 dark:placeholder-neutral-500 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black/20 dark:focus:ring-white/20 ".concat(b?"border-red-500 dark:border-red-400":"border-neutral-200 dark:border-neutral-700"),value:u,onChange:e=>{x(e.target.value),b&&g(null)}}),b&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:b})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300",children:"Password"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{id:"password",type:p?"text":"password",autoComplete:"current-password",className:"mt-1 block w-full rounded-lg border bg-white dark:bg-neutral-950 text-neutral-900 dark:text-neutral-100 placeholder-neutral-400 dark:placeholder-neutral-500 px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-black/20 dark:focus:ring-white/20 ".concat(j?"border-red-500 dark:border-red-400":"border-neutral-200 dark:border-neutral-700"),value:h,onChange:e=>{m(e.target.value),j&&k(null)}}),(0,l.jsx)("button",{type:"button",onClick:()=>f(e=>!e),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200","aria-label":p?"Nascondi password":"Mostra password",children:p?(0,l.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("path",{d:"M17.94 17.94A10.94 10.94 0 0 1 12 20c-5 0-9.27-3-11-8 1.02-2.82 2.98-5.17 5.5-6.56"}),(0,l.jsx)("path",{d:"M1 1l22 22"}),(0,l.jsx)("path",{d:"M9.88 9.88A3 3 0 0 0 12 15a3 3 0 0 0 2.12-.88"}),(0,l.jsx)("path",{d:"M14.12 14.12L9.88 9.88"}),(0,l.jsx)("path",{d:"M21 21l-3-3"})]}):(0,l.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]}),j&&(0,l.jsx)("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:j})]}),(0,l.jsx)(o.P.button,{type:"button",onClick:M,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full rounded-lg h-10 flex items-center justify-center bg-foreground text-background transition-colors hover:bg-[#383838] dark:hover:bg-[#ccc] font-medium",children:"Accedi"}),w&&(0,l.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 text-center",children:w}),(0,l.jsxs)("div",{className:"mt-2 rounded-lg border border-neutral-200 dark:border-neutral-800 p-3 text-sm text-neutral-700 dark:text-neutral-300",children:[(0,l.jsxs)("div",{children:["IP client: ",null!=y?y:"â€”"]}),S&&(0,l.jsxs)("div",{children:["X-Forwarded-For: ",S]})]})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-6 text-center",children:[(0,l.jsxs)("h2",{className:"text-2xl font-semibold tracking-tight",children:["Benvenuto ",s]}),(0,l.jsx)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 mt-1",children:"Sei autenticato. Puoi disconnetterti quando vuoi."})]}),(0,l.jsx)(o.P.button,{type:"button",onClick:A,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full rounded-lg h-10 flex items-center justify-center bg-foreground text-background transition-colors hover:bg-[#383838] dark:hover:bg-[#ccc] font-medium",children:"Disconnetti"})]})})})},{})},{id:"network",label:"Network Test",element:(0,l.jsx)(()=>{let{token:e,apiBaseUrl:t}=(0,i.A)(),[r,s]=(0,a.useState)(null),[n,o]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[x,h]=(0,a.useState)(!1),[m,p]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1),[g,j]=(0,a.useState)(10),[k]=(0,a.useState)(256),w=(0,a.useRef)(0),[v,y]=(0,a.useState)(0),N=(0,a.useMemo)(()=>{let e=Math.max(null!=r?r:0,null!=n?n:0,v);return e<100?100:e<300?300:e<600?600:e<1e3?1e3:500*Math.ceil(e/500)},[r,n,v]),S=async()=>{if(!e)return;b(!1),h(!0),s(null),y(0);let r="".concat(t,"/NetworkTest/stream?durationSec=").concat(g,"&chunkKB=").concat(k),l=performance.now(),a=0,n=0,o=l;try{let t=await fetch(r,{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok&&t.body){let e=t.body.getReader();for(;;){let{done:t,value:r}=await e.read();if(t)break;if(r){a+=r.byteLength;let e=performance.now(),t=(e-o)/1e3;if(t>=.15){let r=a-n,l=8*r/t/1048576;w.current=l,y(l),o=e,n=a}}}let r=(performance.now()-l)/1e3,i=8*a/r/1048576;s(i)}else b(!0)}catch(e){console.error("Download error:",e),b(!0)}h(!1)},C=e=>{let t=new Uint8Array(e);for(let r=0;r<e;r+=65536){let l=Math.min(65536,e-r),a=t.subarray(r,r+l);crypto.getRandomValues(a)}return t},M=async()=>{if(!e)return;b(!1),p(!0),o(null),u(null),y(0);let r="".concat(t,"/NetworkTest/upload"),l=performance.now()+1e3*g,a=0,s=0,n=0;for(;performance.now()<l;){let t=C(4194304);await new Promise(l=>{let o=new XMLHttpRequest;o.open("POST",r,!0),o.setRequestHeader("Authorization","Bearer ".concat(e));let i=performance.now();o.upload.onprogress=e=>{let t=performance.now(),r=Math.max(.001,(t-i)/1e3),l=8*(e.lengthComputable?e.loaded:Math.min(4194304,(t-i)*5e4))/r/1048576;w.current=l,y(l)},o.onreadystatechange=()=>{if(4===o.readyState){a+=4194304;try{let e=JSON.parse(o.responseText);"number"==typeof(null==e?void 0:e.mbps)&&"number"==typeof(null==e?void 0:e.sizeReceived)&&(n+=e.mbps*e.sizeReceived,s+=e.sizeReceived)}catch(e){}l()}};let d=new FormData;d.append("file",new Blob([t],{type:"application/octet-stream"}),"random.dat"),o.send(d)})}o(8*a/g/1048576),s>0&&u(n/s),p(!1)};return(0,l.jsxs)("div",{className:"w-full rounded-2xl border border-black/10 dark:border-white/10 bg-white dark:bg-neutral-900 shadow-lg p-6",children:[(0,l.jsxs)("div",{className:"mb-6 text-center",children:[(0,l.jsx)("div",{className:"mx-auto mb-3 h-12 w-12 rounded-full bg-black/5 dark:bg-white/10 flex items-center justify-center",children:(0,l.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"text-foreground/80",children:[(0,l.jsx)("path",{d:"M20.39 18.39A10 10 0 1 0 5.61 3.61 10 10 0 0 0 20.39 18.39z"}),(0,l.jsx)("path",{d:"M12 12l4-4"})]})}),(0,l.jsx)("h2",{className:"text-2xl font-semibold tracking-tight",children:"Test di Velocit\xe0 di Rete"}),!e&&(0,l.jsx)("p",{className:"mt-1 text-sm text-neutral-600 dark:text-neutral-400",children:"Accedi per eseguire i test"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[(0,l.jsx)("button",{onClick:S,disabled:!e||x||m,className:"rounded-lg h-10 px-4 flex items-center justify-center bg-foreground text-background transition-colors font-medium ".concat(!e||x||m?"opacity-60 cursor-not-allowed":"hover:bg-[#383838] dark:hover:bg-[#ccc]"),children:x?"Download in corsoâ€¦":"Avvia Test Download"}),(0,l.jsx)("button",{onClick:M,disabled:!e||x||m,className:"rounded-lg h-10 px-4 flex items-center justify-center bg-foreground text-background transition-colors font-medium ".concat(!e||x||m?"opacity-60 cursor-not-allowed":"hover:bg-[#383838] dark:hover:bg-[#ccc]"),children:m?"Upload in corsoâ€¦":"Avvia Test Upload"}),(0,l.jsxs)("div",{className:"ml-auto flex items-center gap-2 text-sm",children:[(0,l.jsx)("label",{className:"text-neutral-600 dark:text-neutral-400",children:"Durata:"}),(0,l.jsxs)("select",{className:"rounded-md border border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-950 px-2 py-1",value:g,onChange:e=>j(parseInt(e.target.value,10)),children:[(0,l.jsx)("option",{value:5,children:"5 s"}),(0,l.jsx)("option",{value:10,children:"10 s"}),(0,l.jsx)("option",{value:15,children:"15 s"}),(0,l.jsx)("option",{value:30,children:"30 s"})]})]})]}),(0,l.jsx)("div",{className:"mb-4 flex items-center justify-center",children:(0,l.jsx)(d,{speed:v,max:N,label:"Mbps",showValue:!1})}),(0,l.jsxs)("div",{className:"mb-6 text-center",children:[(0,l.jsxs)("div",{className:"inline-flex items-baseline gap-2 px-4 py-2 rounded-xl bg-black/[.04] dark:bg-white/[.06] border border-black/10 dark:border-white/10",children:[(0,l.jsx)("span",{className:"text-4xl sm:text-5xl font-semibold tracking-tight bg-gradient-to-r from-emerald-500 via-amber-500 to-rose-500 bg-clip-text text-transparent",children:v.toFixed(1)}),(0,l.jsx)("span",{className:"text-lg text-foreground/70",children:"Mbps"})]}),(0,l.jsx)("div",{className:"mt-2 text-sm text-neutral-600 dark:text-neutral-400",children:x?"Download in corso":m?"Upload in corso":"Pronto"})]}),(0,l.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,l.jsxs)("div",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800 p-3",children:[(0,l.jsx)("div",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Velocit\xe0 download media"}),(0,l.jsx)("div",{className:"mt-1 text-xl font-semibold",children:null!==r?"".concat(r.toFixed(2)," Mbps"):"â€”"})]}),(0,l.jsxs)("div",{className:"rounded-lg border border-neutral-200 dark:border-neutral-800 p-3",children:[(0,l.jsx)("div",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:"Velocit\xe0 upload media"}),(0,l.jsx)("div",{className:"mt-1 text-xl font-semibold",children:(null!=c?c:n)!==null?"".concat((null!=c?c:n).toFixed(2)," Mbps"):"â€”"}),null!==c&&null!==n&&(0,l.jsxs)("div",{className:"mt-1 text-xs text-neutral-600 dark:text-neutral-400",children:["client: ",n.toFixed(2)," Mbps \xb7 server: ",c.toFixed(2)," Mbps"]})]})]}),f&&(0,l.jsx)("p",{className:"mt-4 text-sm text-red-600 dark:text-red-400",children:"Si \xe8 verificato un errore durante il test."})]})},{})}],u=c[0].id;function x(){var e;let t=(0,s.useSearchParams)().get("tool")||u,r=null!==(e=c.find(e=>e.id===t))&&void 0!==e?e:c[0];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"row-start-1 w-full flex items-center justify-center",children:(0,l.jsx)(n,{items:c.map(e=>{let{id:t,label:r}=e;return{id:t,label:r}}),activeId:r.id})}),(0,l.jsx)("main",{className:"flex flex-col gap-[32px] row-start-2 items-center sm:items-start w-full max-w-3xl",children:(0,l.jsx)("div",{className:"w-full",children:r.element})}),(0,l.jsx)("footer",{className:"row-start-3"})]})}function h(){return(0,l.jsx)("div",{className:"grid grid-rows-[auto_1fr_20px] items-center justify-items-center min-h-screen p-8 pb-20 gap-16 sm:p-20 font-[family-name:var(--font-geist-sans)]",children:(0,l.jsx)(a.Suspense,{fallback:(0,l.jsx)("div",{className:"row-start-2",children:"Caricamentoâ€¦"}),children:(0,l.jsx)(x,{})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[417,441,684,358],()=>t(3107)),_N_E=e.O()}]);